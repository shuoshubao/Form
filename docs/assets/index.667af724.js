var e=Object.defineProperty,t=Object.prototype.hasOwnProperty,a=Object.getOwnPropertySymbols,l=Object.prototype.propertyIsEnumerable,n=(t,a,l)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[a]=l,s=(e,s)=>{for(var o in s||(s={}))t.call(s,o)&&n(e,o,s[o]);if(a)for(var o of a(s))l.call(s,o)&&n(e,o,s[o]);return e},o=(e,t,a)=>(n(e,"symbol"!=typeof t?t+"":t,a),a);import{r,p as i,l as c,S as u,c as p,i as m,f as d,T as h,Q as f,a as b,s as v,I as y,b as g,d as E,e as k,g as S,h as C,D as w,B as V,j as R,R as Y,C as _,F,k as T,m as j,n as P,o as D,U as M,q as N,t as x,u as B,z as I}from"./vendor.578874f1.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(a){const l=new URL(e,location),n=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((a,s)=>{const o=new URL(e,l);if(self[t].moduleMap[o])return a(self[t].moduleMap[o]);const r=new Blob([`import * as m from '${o}';`,`${t}.moduleMap['${o}']=m;`],{type:"text/javascript"}),i=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(r),onerror(){s(new Error(`Failed to import: ${e}`)),n(i)},onload(){a(self[t].moduleMap[o]),n(i)}});document.head.appendChild(i)})),self[t].moduleMap={}}}("https:/shuoshubao.github.io/Search/assets/");class W extends r.Component{constructor(){super(...arguments),o(this,"onChange",((e,t)=>{c.isFunction(this.props.onChange)&&this.props.onChange(e,t)}))}render(){const{defaultValue:e,value:t,style:a}=this.props,{onChange:l}=this,n=c.omit(this.props,["defaultValue","value","onChange","style"]);return r.createElement("div",{style:a},r.createElement(u,s({checked:t,defaultChecked:e,onChange:l},n)))}}o(W,"displayName","SearchSwitch"),o(W,"defaultProps",{}),o(W,"propTypes",{value:i.bool,onChange:i.func});const O="DynaSearch",$=c.kebabCase(O),L={size:"small",bordered:!1},q={layout:"inline"},H={label:"",name:"",visible:!0,defaultValue:"",immediate:!0,tooltip:"",placeholder:"",isSearch:!1,inline:!0,style:{},formItemStyle:{},template:{tpl:"input",width:200}},U={date:"YYYY-MM-DD",year:"YYYY",month:"YYYY-MM",week:"YYYY-wo",quarter:"quarter"},A=["input","search","select-search","select-input"],z=(e="")=>[O,e].join(""),K=(...e)=>p(e).split(" ").map((e=>[$,e].join("-"))).join(" "),G=e=>{const{template:t}=e,{tpl:a,width:l}=t,n={};return["radio","checkbox","range-picker"].includes(a)?n.width=void 0:n.width=l,n},Q=/\[(.+?)\|(.+?)\]/g,J=e=>c.flatten([e]).filter(Boolean).map(String).map((e=>e.replace(/\\n/g,"<br>"))).map((e=>e.replace(Q,((...e)=>{const[,t,a]=e;return b({tagName:"a",attrs:{href:a,target:"_blank",style:{color:"#fff",fontWeight:"bold",textDecoration:"underline"}},text:t})})))).map(((e,t)=>r.createElement("div",{key:[t].join(),dangerouslySetInnerHTML:{__html:e}})));class X extends r.Component{constructor(e){super(e),o(this,"onSelectChange",(async e=>{await v(this,{selectValue:e}),this.onChange()})),o(this,"onInputChange",(async e=>{await v(this,{inputValue:e.target.value}),this.onChange()})),o(this,"onSearch",(()=>{const{props:e,state:t}=this,{onSearch:a}=e;c.isFunction(a)&&a()})),o(this,"onChange",(()=>{const{props:e,state:t}=this,{onChange:a}=e;if(!c.isFunction(a))return;const{column:l,value:n,style:s}=e,{selectValue:o,inputValue:r}=t,{name:i,inline:u,template:p}=l,{inputType:m}=p;if(!["input","search"].includes(m))return["select-search","select-input"].includes(m)?(i.split("___"),void a([o,r])):void 0;a(r)})),this.state={selectValue:null,inputValue:""}}componentDidMount(){const{props:e,state:t,onSelectChange:a,onInputChange:l}=this,{column:n,value:s,style:o}=e,{name:r,defaultValue:i,inline:c,template:u}=n,{inputType:p,options:m,selectWidth:d,inputWidth:h}=u;["select-search","select-input"].includes(p)&&(""===i&&this.setState({selectValue:m[0].value}),Array.isArray(i)&&2===i.length&&this.setState({selectValue:i[0],inputValue:i[1]}))}render(){const{props:e,state:t,onSelectChange:a,onInputChange:l,onSearch:n}=this,{column:o,defaultValue:i,value:u,style:p}=e,{selectValue:m,inputValue:d}=t,{name:h,inline:f,template:b}=o,{inputType:v,options:E,selectWidth:k,inputWidth:S}=b,C=c.omit(e,["column","defaultValue","value","onChange","onSearch","style"]);if(C.style={width:S},"search"===v)return r.createElement(y.Search,s(s({},C),{defaultValue:i,value:d,onChange:l,onSearch:()=>{n()}}));if(["select-search","select-input"].includes(v)){const{label:e}=E.find((e=>e.value===m))||{};return r.createElement(y.Group,{compact:!0},r.createElement(g,{value:m,onChange:a,options:E,style:{width:k}}),"select-search"===v?r.createElement(y.Search,s(s({},C),{value:d,onChange:l,onSearch:()=>{n()},placeholder:["请输入",e].join("")})):r.createElement(y,s(s({},C),{value:d,onChange:l,placeholder:["请输入",e].join("")})))}return r.createElement(y,s({},C))}}o(X,"displayName",z("Input")),o(X,"defaultProps",{}),o(X,"propTypes",{value:i.any,onChange:i.func,onSearch:i.func,column:i.object});class Z extends r.Component{constructor(e){super(e),o(this,"setFields",(()=>{const{props:e,state:t}=this,{columns:a,getFieldsValue:l}=e,n=l(),s=[];c.sortBy(Object.entries(n),(([e])=>a.findIndex((t=>t.name===e)))).filter((([e,t])=>E(S(t),k(t)))).forEach((([e,t])=>{const l=c.find(a,{name:e}),{name:n,label:o,template:r}=l,{tpl:i,options:u}=r;if(["select","radio","checkbox","date-picker","range-picker"].includes(i)){if(["date-picker","range-picker"].includes(i)){const{format:e}=r;let a=d(t,e);return["range-picker"].includes(i)&&(a=[d(t[0],e),d(t[1],e)].join(" - ")),void s.push({name:n,value:t,label:o,valueText:a})}["select","radio","checkbox"].includes(i)&&c.sortBy(c.flatten([t]),(e=>u.findIndex((t=>t.value===e)))).forEach((e=>{const t=C(e,u);s.push({name:n,value:e,label:o,valueText:t})}))}})),this.setState({data:s})})),o(this,"onRemove",((e,t)=>{const{props:a,state:l}=this,{onChange:n,columns:s,getFieldsValue:o}=a,r=o(),{name:i,value:u}=e,p=c.find(s,{name:i}),{template:m}=p,{tpl:d}=m;this.setState((e=>{const a=c.cloneDeep(e.data);return a.splice(t,1),{data:a}}));let h=c.cloneDeep(r[i]);Array.isArray(h)?"range-picker"===d?h="":c.remove(h,(e=>e===u)):h="",n([{name:i,value:h}])})),this.state={data:[]}}componentDidMount(){}render(){const{props:e,state:t,onRemove:a}=this,{data:l}=t;return k(l)?null:r.createElement("div",{className:K("filter-panel")},r.createElement(w,{orientation:"left"},r.createElement("span",null,"已选"),r.createElement(V,{count:l.length,offset:[5,-3],size:"small"})),l.map(((e,t)=>{const{label:l,value:n,valueText:s}=e,o=`${l}(${s})`;return r.createElement(R,{color:"blue",closable:!0,key:[t,n].join(),onClose:()=>{a(e,t)}},o)})))}}o(Z,"displayName",z("FilterPanel")),o(Z,"defaultProps",{}),o(Z,"propTypes",{columns:i.array.isRequired,getFieldsValue:i.func.isRequired,onChange:i.func.isRequired});const{RangePicker:ee}=D;class te extends r.Component{constructor(e){super(e),this.state={columns:[],initialValues:{}},this.formRef=r.createRef(),this.filterPanelRef=r.createRef(),this.customEvents=this.getCustomEvents(),this.domEvents=this.getDomEvents(),this.renderResult=this.getRenderResult()}async componentDidMount(){const{columns:e,autoSubmit:t}=this.props,a=((e=[])=>c.cloneDeep(e).map(((e,t)=>{const a=c.merge({},H,e),{name:l,label:n,defaultValue:o}=a;let{template:r}=a;const{tpl:i}=r;if("input"===i){r=s({inputType:"input",inputWidth:H.template.width},r);const{inputType:e}=r;if(a.placeholder=n?["请输入",n].join(""):"",["select-search","select-input"].includes(e)){r=s({selectWidth:100,options:[]},r);const[e,t]=l.split(",");a.name=[e,t].join("___")}}if("select"===i&&(a.placeholder=n?["请选择",n].join(""):"",a.defaultValue=o===H.defaultValue?void 0:o),"cascader"===i&&(a.placeholder=n?["请选择",n].join(""):"",a.defaultValue=o===H.defaultValue?[]:o),"checkbox"===i&&(a.defaultValue=o===H.defaultValue?[]:o),"date-picker"===i&&(r=s({picker:"date"},r),r=s({format:U[r.picker]},r),a.placeholder=void 0),"range-picker"===i){const[e,t]=l.split(",");a.name=[e,t].join("___"),r=s({format:"YYYY-MM-DD HH:mm:ss"},r),a.placeholder=void 0}return a.template=r,a})).filter((e=>Boolean(e.visible))))(e);((e=[])=>{e.forEach((e=>{const{name:t,label:a,defaultValue:l,template:n}=e,{tpl:s}=n;if("input"===s){const{inputType:e="input"}=n;if(!A.includes(e))throw new Error(`[${O}]inputType 参数非法, 需为其中一种: ${A.join("|")}`);if(["select-search","select-input"].includes(e)){const[e,a]=t.split("___");if(m(e,a))throw new Error(`[${O}]range-picker 必须传参数: "name" 需为长度为 "selectKey,inputKey"`)}}if("range-picker"===s){const[e,a]=t.split("___");if(m(e,a))throw new Error(`[${O}]range-picker 必须传参数: "name" 需为长度为 "startTimeKey,endTimeKey"`)}}))})(a);const l=((e=[])=>c.cloneDeep(e).reduce(((e,t)=>{const{name:a,defaultValue:l,template:n}=t,{tpl:s}=n;if("range-picker"===s){const[t,l]=a.split("___");return e[t]="",e[l]="",e}return e[a]=l,e}),{}))(a);await v(this,{columns:a,initialValues:l}),k(a)||t&&this.domEvents.onSearch()}getCustomEvents(){return{}}getDomEvents(){return{onImmediateSearch:e=>{const{immediate:t,template:a}=e,{tpl:l}=a;this.domEvents.debounceFilterPanelSetFields(),t&&(["input"].includes(l)||this.domEvents.onSearch())},onSearch:c.debounce((()=>{const{state:e,props:t}=this,{columns:a}=e,l=this.formRef.current.getFieldsValue(),n=((e,t)=>{const a={};return t.forEach((t=>{const{name:l,defaultValue:n,template:s}=t,{tpl:o}=s,r=e[l];if("input"===o){const{inputType:e}=s;if(["select-search","select-input"].includes(e)){const[e,t]=l.split("___");return a[e]=r[0],void(a[t]=r[1])}}if("date-picker"!==o)if("range-picker"!==o)a[l]=r;else{const{format:e}=s,[t,n]=l.split("___");r?(a[t]=d(r[0],e),a[n]=d(r[1],e)):(a[t]="",a[n]="")}else{const{format:e}=s;a[l]=r?d(r,e):n}})),a})(l,a);c.isFunction(t.onSubmit)&&t.onSubmit(n,l),this.domEvents.debounceFilterPanelSetFields()}),100),debounceFilterPanelSetFields:c.debounce((()=>{const{visibleFilterPanel:e}=this.props;e&&this.filterPanelRef.current.setFields()}),110),onReset:()=>{this.formRef.current.resetFields(),this.domEvents.onSearch()}}}getRenderResult(){return{renderColumns:()=>{const{props:e,state:t}=this,{columns:a}=t,l=e.labelWidth||(e=>{if(1===e.length)return 0;const t=e.map((e=>{const{label:t,tooltip:a}=e;let l=14*t.length;return a.length&&(l+=19),l}));return Math.max(...t)})(a);return a.map(((e,t)=>{const{label:a,name:n,inline:o,template:i}=e,{tpl:u}=i,p=(e=>{const{placeholder:t,template:a}=c.cloneDeep(e);return s({placeholder:t,style:G(e)},c.omit(a,["width","tpl"]))})(e);p.onChange=()=>{this.domEvents.onImmediateSearch(e)};let m=null;"input"===u&&(m=r.createElement(X,s(s({column:e},p),{onSearch:()=>{this.domEvents.onSearch()}}))),"select"===u&&(m=r.createElement(g,s({},p))),"cascader"===u&&(m=r.createElement(P,s({},p))),"radio"===u&&(m=r.createElement(Y.Group,s({},p))),"checkbox"===u&&(m=r.createElement(_.Group,s({},p))),"date-picker"===u&&(m=r.createElement(D,s({},p))),"range-picker"===u&&(m=r.createElement(ee,s({},p))),"switch"===u&&(m=r.createElement(W,s({},p)));const d=((e,{labelWidth:t})=>{const{label:a,tooltip:l}=e;return a.trim()?r.createElement("div",{style:{width:t||void 0}},r.createElement("span",null,a),!!l&&r.createElement(h,{title:J(l),overlayClassName:K("tooltip")},r.createElement(f,{style:{marginLeft:5}}))):null})(e,{labelWidth:l}),b=[t,a,n].join("_");return r.createElement(F.Item,{label:d,name:n,key:b,style:{width:o?void 0:"100%"}},m)}))},renderSearchReset:()=>{const{state:e,domEvents:t}=this,{columns:a}=e,{onReset:l}=t,{showSearchBtn:n,showResetBtn:s}=this.props;if(E(n,s))return null;let o=n,i=s;if(1===a.length){const{template:e}=a[0],{tpl:t,inputType:l}=e;"input"===t&&"input"==l&&(o=!0),i=!1}return r.createElement(F.Item,{className:K("form-item",{"form-item-hide-submit":!o,"form-item-hide-reset":!i})},r.createElement(T,{type:"primary",htmlType:"submit",key:"submit",className:K("form-item-submit")},"查询"),r.createElement(T,{onClick:l,key:"reset",className:K("form-item-reset")},"重置"))}}}render(){const{props:e,state:t,domEvents:a,renderResult:l}=this,{columns:n,initialValues:o}=t,{visibleFilterPanel:i}=e,{onSearch:u}=a;if(k(n))return null;const p=c.merge({},e.cardProps,L),m=c.merge({},e.formProps,q);return r.createElement(j,s({className:K("container")},p),r.createElement(F,s(s({ref:this.formRef},c.omit(m,["ref","onFinish","initialValues"])),{onFinish:u,initialValues:o}),l.renderColumns(),l.renderSearchReset()),i&&r.createElement(Z,{ref:this.filterPanelRef,columns:n,getFieldsValue:()=>this.formRef.current.getFieldsValue(),onChange:e=>{this.formRef.current.setFields(e),this.domEvents.onSearch()}}))}}o(te,"displayName",O),o(te,"defaultProps",{autoSubmit:!0,showSearchBtn:!1,showResetBtn:!0,cardProps:{},formProps:{},labelWidth:0,visibleFilterPanel:!1}),o(te,"propTypes",{columns:i.array.isRequired,autoSubmit:i.bool,showSearchBtn:i.bool,showResetBtn:i.bool,onSubmit:i.func,cardProps:i.object,formProps:i.object,labelWidth:i.number,visibleFilterPanel:i.bool});const ae=[{label:"关键字1",name:"a1",tooltip:["这里填写姓名","a[a|https://ke.com]b"],template:{inputType:"search"}},{label:"关键字2",name:"a2",tooltip:["这里填写姓名","a[a|https://ke.com]b"],template:{inputType:"search",enterButton:"搜索"}},{label:"关键字3",name:"a3,a31",tooltip:["这里填写姓名","a[a|https://ke.com]b"],inline:!1,template:{inputType:"select-search",options:[{label:"交易编号",value:"businessCode"},{label:"合同编号",value:"contractNo"},{label:"买方",value:"buyerName"},{label:"卖方",value:"sellerName"}]}},{label:"关键字4",name:"a4,a41",tooltip:["这里填写姓名","a[a|https://ke.com]b"],inline:!1,template:{inputType:"select-search",enterButton:"搜索",options:[{label:"交易编号",value:"businessCode"},{label:"合同编号",value:"contractNo"},{label:"买方",value:"buyerName"},{label:"卖方",value:"sellerName"}]}},{label:"关键字5",name:"a5,a51",tooltip:["这里填写姓名","a[a|https://ke.com]b"],inline:!1,template:{inputType:"select-input",enterButton:"搜索",options:[{label:"交易编号",value:"businessCode"},{label:"合同编号",value:"contractNo"},{label:"买方",value:"buyerName"},{label:"卖方",value:"sellerName"}]}},{label:"姓名",name:"b",tooltip:["这里填写姓名","a[a|https://ke.com]b"]},{label:"搜索框",name:"a",template:{inputType:"search",prefix:r.createElement(M,null),enterButton:!0,allowClear:!0}},{label:"性别",name:"c",defaultValue:2,template:{tpl:"select",allowClear:!0,options:[{label:"男",value:1,disabled:!0},{label:"女",value:2}]}},{label:"创建时间1",name:"d",tooltip:"创建时间1",template:{tpl:"date-picker"}},{label:"创建时间2",name:"d1",template:{tpl:"date-picker",format:"YYYY-MM-DD HH:mm",showTime:!0}},{label:"创建时间3",name:"d2",template:{tpl:"date-picker",format:"YYYY-MM-DD HH:mm:ss",showTime:!0}},{label:"创建时间4",name:"d3",template:{tpl:"date-picker",picker:"month"}},{label:"时间区间",name:"sTime,eTime",inline:!1,template:{tpl:"range-picker",format:"YYYY-MM-DD"}},{label:"状态",name:"f",inline:!1,template:{tpl:"radio",options:[{label:"待存管",value:1},{label:"部分存管",value:2,disabled:!0},{label:"存管完成",value:3},{label:"已解冻",value:4}]}},{label:"状态",name:"g",inline:!1,template:{tpl:"checkbox",options:[{label:"待存管",value:1},{label:"部分存管",value:2,disabled:!0},{label:"存管完成",value:3},{label:"已解冻",value:4}]}},{label:"开关",name:"h",defaultValue:!0,template:{tpl:"switch"}}];var le=()=>r.createElement("div",{className:"App",style:{padding:10,background:"#edf0f3"}},r.createElement(te,{columns:ae,onSubmit:(e,t)=>{console.log("搜索:"),console.log(e)},visibleFilterPanel:!0}));N.locale("zh-cn"),x.render(r.createElement(r.StrictMode,null,r.createElement(B,{locale:I},r.createElement(le,null))),document.getElementById("root"));
